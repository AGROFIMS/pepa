---
title: "Descriptive report for a numeric trait"
author: "International Potato Center"
date: '`r format(Sys.time(), "%B %d, %Y")`'
output: 
  html_document:
    theme: united
  pdf_document:
    toc: true
    highlight: zenburn
  word_document:
    highlight: "tango"
params: 
  x: "no data"
---

```{r, echo = FALSE}
object <- params$x

# Some parameters
p1 <- length(object)
p2 <- max(table(object))
p3 <- length(table(object))

# Compute skewness parameter
sk <- 3*(mean(object) - median(object))/sd(object)
```

It looks like you have a numeric trait. You can see a descriptive summary below:
```{r, echo = FALSE}
output <- summary(object)
output
```

`r if(sk > 0.5) {"It looks like you have some positive skewness because your mean is quite larger than your median. Watch out with this if you want to fit a model that assumes normality." }`

`r if(sk < -0.5) {"It looks like you have some negative skewness because your mean is quite smaller than your median. Watch out with this if you want to fit a model that assumes normality." }`

`r if(p1 > 25 & (p1/p3 <= 2 | (p1/p3 > 2 & p3 > 20))) {"A boxplot could be a suitable plot for these data:"}`

```{r, echo = FALSE}
if(p1 > 25 & (p1/p3 <= 2 | (p1/p3 > 2 & p3 > 20))) boxplot(object)
```
`r if(p1 > 25 & p1/p3 > 2 & p3 <= 20) {"For this trait a frequency table could produce a good display of the data:"}`

```{r, echo = FALSE}
if(p1 > 25 & p1/p3 > 2 & p3 <= 20) table(object)
```

`r if(p1 <= 25) {"A dotplot could be a suitable plot for these data:"}`

```{r, echo = FALSE}
if(p1 <= 25) dotplot(object)
```

`r if(p1 > 25 & p1/p3 < 2 & p2/p1 > 0.05) {"Although your trait seems to be on a continuous scale, there are some values with a very high frequency. What out with this if you plan to fit a model that assumes normality. You can see these values and their frequency below:"}`

```{r, echo = FALSE}
if(p1 > 25 & p1/p3 < 2 & p2/p1 > 0.05) table(object)[table(object)/p1 > 0.05]
```
